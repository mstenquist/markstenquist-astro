---
export interface Props {
	currentPage: number;
	totalPages: number;
	baseUrl: string;
}

const { currentPage, totalPages, baseUrl } = Astro.props;

// Generate pagination array with smart truncation
function generatePaginationArray(current: number, total: number) {
	const pages: (number | 'ellipsis')[] = [];
	
	if (total <= 7) {
		// Show all pages if 7 or fewer
		for (let i = 1; i <= total; i++) {
			pages.push(i);
		}
	} else {
		// Smart pagination for many pages
		if (current <= 4) {
			// Near beginning: 1,2,3,4,5...last
			for (let i = 1; i <= 5; i++) pages.push(i);
			if (total > 6) pages.push('ellipsis');
			pages.push(total);
		} else if (current >= total - 3) {
			// Near end: 1...last-4,last-3,last-2,last-1,last
			pages.push(1);
			if (total > 6) pages.push('ellipsis');
			for (let i = total - 4; i <= total; i++) pages.push(i);
		} else {
			// Middle: 1...current-1,current,current+1...last
			pages.push(1);
			pages.push('ellipsis');
			for (let i = current - 1; i <= current + 1; i++) pages.push(i);
			pages.push('ellipsis');
			pages.push(total);
		}
	}
	
	return pages;
}

const paginationPages = generatePaginationArray(currentPage, totalPages);
---

{totalPages > 1 && (
	<div class="flex justify-center items-center mt-8 space-x-4">
		{currentPage > 1 ? (
			<a 
				href={`${baseUrl}?page=${currentPage - 1}`}
				class="px-4 py-2 rounded-lg bg-white border border-gray-300 text-gray-600 hover:bg-gray-50 transition-colors"
			>
				Previous
			</a>
		) : (
			<span class="px-4 py-2 rounded-lg bg-gray-100 border border-gray-200 text-gray-400 cursor-not-allowed">
				Previous
			</span>
		)}
		
		<div class="flex space-x-2">
			{paginationPages.map((page, index) => 
				page === 'ellipsis' ? (
					<span key={`ellipsis-${index}`} class="px-3 py-2 text-gray-400">...</span>
				) : (
					<a 
						key={page}
						href={`${baseUrl}?page=${page}`}
						class={`px-3 py-2 rounded-lg transition-colors ${
							currentPage === page 
								? 'bg-blue-600 text-white' 
								: 'bg-white border border-gray-300 text-gray-600 hover:bg-gray-50'
						}`}
					>
						{page}
					</a>
				)
			)}
		</div>
		
		{currentPage < totalPages ? (
			<a 
				href={`${baseUrl}?page=${currentPage + 1}`}
				class="px-4 py-2 rounded-lg bg-white border border-gray-300 text-gray-600 hover:bg-gray-50 transition-colors"
			>
				Next
			</a>
		) : (
			<span class="px-4 py-2 rounded-lg bg-gray-100 border border-gray-200 text-gray-400 cursor-not-allowed">
				Next
			</span>
		)}
	</div>
)}